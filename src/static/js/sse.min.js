(()=>{var u;function t(e){return new EventSource(e,{withCredentials:!0})}function o(i){if(u.getAttributeValue(i,"sse-swap")){if(null==(g=u.getClosestMatch(i,n)))return;for(var c=u.getInternalData(g).sseEventSource,e=u.getAttributeValue(i,"sse-swap").split(","),t=0;t<e.length;t++){let a=e[t].trim(),o=function(e){var t,n,r,s;l(g)||(u.bodyContains(i)?u.triggerEvent(i,"htmx:sseBeforeMessage",e)&&(t=i,n=e.data,u.withExtensions(t,function(e){n=e.transformResponse(n,null,t)}),r=u.getSwapSpecification(t),s=u.getTarget(t),u.swap(s,n,r,{contextElement:t}),u.triggerEvent(i,"htmx:sseMessage",e)):c.removeEventListener(a,o))};u.getInternalData(i).sseEventListener=o,c.addEventListener(a,o)}}var g;u.getAttributeValue(i,"hx-trigger")&&null!=(g=u.getClosestMatch(i,n))&&(c=u.getInternalData(g).sseEventSource,u.getTriggerSpecs(i).forEach(function(t){var n;"sse:"===t.trigger.slice(0,4)&&(n=function(e){l(g)||(u.bodyContains(i)||c.removeEventListener(t.trigger.slice(4),n),htmx.trigger(i,t.trigger,e),htmx.trigger(i,"htmx:sseMessage",e))},u.getInternalData(i).sseEventListener=n,c.addEventListener(t.trigger.slice(4),n))}))}function i(e,t){if(null!=e){if(u.getAttributeValue(e,"sse-connect")){var n=u.getAttributeValue(e,"sse-connect");if(null==n)return;r=e,n=n,s=t,(a=htmx.createEventSource(n)).onerror=function(e){var t,n;u.triggerErrorEvent(r,"htmx:sseError",{error:e,source:a}),l(r)||(t=u.getInternalData(r)).sseReconnecting||a.readyState===EventSource.CLOSED&&(t.sseReconnecting=!0,n=s||0,n=Math.max(Math.min(2*n,128),1),window.setTimeout(function(){t.sseReconnecting=!1,i(r,n)},500*n))},a.onopen=function(e){if(u.triggerEvent(r,"htmx:sseOpen",{source:a}),s&&0<s){var t=r.querySelectorAll("[sse-swap], [data-sse-swap], [hx-trigger], [data-hx-trigger]");for(let e=0;e<t.length;e++)o(t[e]);s=0}},u.getInternalData(r).sseEventSource=a,(n=u.getAttributeValue(r,"sse-close"))&&a.addEventListener(n,function(){u.triggerEvent(r,"htmx:sseClose",{source:a,type:"message"}),a.close()})}var r,s,a;o(e)}}function l(e){if(!u.bodyContains(e)){var t=u.getInternalData(e).sseEventSource;if(null!=t)return u.triggerEvent(e,"htmx:sseClose",{source:t,type:"nodeMissing"}),t.close(),1}}function n(e){return null!=u.getInternalData(e).sseEventSource}htmx.defineExtension("sse",{init:function(e){u=e,null==htmx.createEventSource&&(htmx.createEventSource=t)},getSelectors:function(){return["[sse-connect]","[data-sse-connect]","[sse-swap]","[data-sse-swap]"]},onEvent:function(e,t){var n=t.target||t.detail.elt;switch(e){case"htmx:beforeCleanupElement":var r=u.getInternalData(n),s=r.sseEventSource;return void(s&&(u.triggerEvent(n,"htmx:sseClose",{source:s,type:"nodeReplaced"}),r.sseEventSource.close()));case"htmx:afterProcessNode":i(n)}}})})();